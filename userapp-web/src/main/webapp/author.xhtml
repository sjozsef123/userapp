<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" />
	<f:metadata>
		<f:viewAction action="#{loginmanagedbean.isAdmin()}" />
	</f:metadata>
	<title>#{msg['web.author.title']}</title>
</h:head>
<body>
	<p:messages id="messages" showDetail="false" autoUpdate="true"
		closable="true" />

	<h:panelGrid id="panel" columns="2" border="0" cellpadding="20"
		cellspacing="1">

		<h:column>
			<ui:include src="/includes/navigation.xhtml" />
		</h:column>

		<h:column>
			<p:panel header="#{msg['web.author.authors']}">
				<h:form>
					<p:panelGrid columns="2">

						<h:column>
							<h:outputLabel value="#{msg['web.title']}" />
							<br />
							<h:inputText value="#{authorManagedBean.author.name}"
								required="true"
								requiredMessage="#{msg['error.validation.required']}"
								validatorMessage="#{msg['error.validation.mincharacter']}">
								<f:validateLength minimum="3" />
							</h:inputText>
						</h:column>

						<h:column>
							<h:outputLabel value="#{msg['web.add']}" />
							<br />
							<p:commandButton action="#{authorManagedBean.add()}"
								title="#{msg['web.add']}" icon="ui-icon-add" ajax="false" />
						</h:column>
					</p:panelGrid>
				</h:form>

				<p:spacer height="30px;" />
				<h:form id="form1">
					<p:defaultCommand target="dummy" />
					<p:commandButton id="dummy" process="@none" global="false"
						style="display:none;" />

					<p:dataTable id="authorTable"
						value="#{authorManagedBean.lazyModel}" var="a" widgetVar="50"
						editable="true" paginator="true" rows="5"
						paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
						rowsPerPageTemplate="5,10,15" lazy="true">
						<f:facet name="header">  
                    			#{msg['web.author.authors']}
                    		</f:facet>

						<p:ajax event="rowEdit" listener="#{authorManagedBean.onEdit}"
							update="messages" />

						<p:ajax event="rowEditCancel"
							listener="#{authorManagedBean.onCancel}" update=":messages" />

						<p:column>
							<f:facet name="header">
								<h:outputText value="#{msg['web.name']}" />
								<p:inputText id="titleFilter"
									value="#{authorManagedBean.searchName}">
									<p:ajax event="keyup" update="form1:authorTable"
										process="titleFilter" />
								</p:inputText>
							</f:facet>
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{a.name}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText value="#{a.name}" style="width:100%" />
								</f:facet>
							</p:cellEditor>
						</p:column>
						<p:column headerText="#{msg['web.operations']}"
							style="width:110px">
							<p:rowEditor />
							<p:commandButton action="#{authorManagedBean.delete(a)}"
								title="#{msg['web.delete']}" icon="ui-icon-close" ajax="true"
								update="authorTable" process="@this">
							</p:commandButton>
						</p:column>
					</p:dataTable>
				</h:form>
			</p:panel>
		</h:column>
	</h:panelGrid>
	<ui:include src="/includes/footer.xhtml" />
</body>
</html>